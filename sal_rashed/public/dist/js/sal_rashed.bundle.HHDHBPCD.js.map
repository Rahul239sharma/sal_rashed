{
  "version": 3,
  "sources": ["../../../../../apps/sal_rashed/sal_rashed/public/js/new_pos_post_order_summary.js", "../../../../../apps/sal_rashed/sal_rashed/public/js/new_pos_item_cart.js", "../../../../../apps/sal_rashed/sal_rashed/public/js/new_pos_payment.js"],
  "sourcesContent": ["function overridePOSSummary() {\n    if (typeof erpnext !== 'undefined' &&\n        typeof erpnext.PointOfSale !== 'undefined' &&\n        typeof erpnext.PointOfSale.PastOrderSummary !== 'undefined') {\n        \n        erpnext.PointOfSale.PastOrderSummary.prototype.get_condition_btn_map = function(after_submission) {\n            if (after_submission)\n                return [{ condition: true, visible_btns: [\"Print Receipt\", \"New Order\"] }];\n    \n            return [\n                { condition: this.doc.docstatus === 0, visible_btns: [\"Edit Order\", \"Delete Order\"] },\n                {\n                    condition: !this.doc.is_return && this.doc.docstatus === 1,\n                    visible_btns: [\"Print Receipt\", \"Return\"],\n                },\n                {\n                    condition: this.doc.is_return && this.doc.docstatus === 1,\n                    visible_btns: [\"Print Receipt\"],\n                },\n            ];\n        };\n    } else {\n        setTimeout(overridePOSSummary, 100);\n    }\n}\n overridePOSSummary();", "function overridePOSItemCart() {\n    if (typeof erpnext !== 'undefined' &&\n        typeof erpnext.PointOfSale !== 'undefined' &&\n        typeof erpnext.PointOfSale.ItemCart !== 'undefined') {\n        \n        erpnext.PointOfSale.ItemCart.prototype.render_customer_fields = function(after_submission) {\n            const $customer_form = this.$customer_section.find(\".customer-fields-container\");\n\n            const dfs = [\n                {\n                    fieldname: \"email_id\",\n                    label: __(\"Email\"),\n                    fieldtype: \"Data\",\n                    options: \"email\",\n                    placeholder: __(\"Enter customer's email\"),\n                },\n                {\n                    fieldname: \"mobile_no\",\n                    label: __(\"Phone Number\"),\n                    fieldtype: \"Data\",\n                    placeholder: __(\"Enter customer's phone number\"),\n                },\n                // {\n                //     fieldname: \"loyalty_program\",\n                //     label: __(\"Loyalty Program\"),\n                //     fieldtype: \"Link\",\n                //     options: \"Loyalty Program\",\n                //     placeholder: __(\"Select Loyalty Program\"),\n                // },\n                // {\n                //     fieldname: \"loyalty_points\",\n                //     label: __(\"Loyalty Points\"),\n                //     fieldtype: \"Data\",\n                //     read_only: 1,\n                // },\n            ];\n    \n            const me = this;\n            dfs.forEach((df) => {\n                this[`customer_${df.fieldname}_field`] = frappe.ui.form.make_control({\n                    df: { ...df, onchange: handle_customer_field_change },\n                    parent: $customer_form.find(`.${df.fieldname}-field`),\n                    render_input: true,\n                });\n                this[`customer_${df.fieldname}_field`].set_value(this.customer_info[df.fieldname]);\n            });\n    \n            function handle_customer_field_change() {\n                const current_value = me.customer_info[this.df.fieldname];\n                const current_customer = me.customer_info.customer;\n    \n                if (this.value && current_value != this.value && this.df.fieldname != \"loyalty_points\") {\n                    frappe.call({\n                        method: \"erpnext.selling.page.point_of_sale.point_of_sale.set_customer_info\",\n                        args: {\n                            fieldname: this.df.fieldname,\n                            customer: current_customer,\n                            value: this.value,\n                        },\n                        callback: (r) => {\n                            if (!r.exc) {\n                                me.customer_info[this.df.fieldname] = this.value;\n                                frappe.show_alert({\n                                    message: __(\"Customer contact updated successfully.\"),\n                                    indicator: \"green\",\n                                });\n                                frappe.utils.play_sound(\"submit\");\n                            }\n                        },\n                    });\n                }\n            }\n        };\n    } else {\n        setTimeout(overridePOSItemCart, 100);\n    }\n\n}\noverridePOSItemCart();", "function overridePOSPayment() {\n    if (typeof erpnext !== 'undefined' &&\n        typeof erpnext.PointOfSale !== 'undefined' &&\n        typeof erpnext.PointOfSale.Payment !== 'undefined') {\n        \n        erpnext.PointOfSale.Payment.prototype.bind_events = function() {\n            const me = this;\n\n            this.$payment_modes.on(\"click\", \".mode-of-payment\", function (e) {\n                const mode_clicked = $(this);\n                // if clicked element doesn't have .mode-of-payment class then return\n                if (!$(e.target).is(mode_clicked)) return;\n    \n                const scrollLeft =\n                    mode_clicked.offset().left - me.$payment_modes.offset().left + me.$payment_modes.scrollLeft();\n                me.$payment_modes.animate({ scrollLeft });\n    \n                const mode = mode_clicked.attr(\"data-mode\");\n    \n                // hide all control fields and shortcuts\n                $(`.mode-of-payment-control`).css(\"display\", \"none\");\n                $(`.cash-shortcuts`).css(\"display\", \"none\");\n                me.$payment_modes.find(`.pay-amount`).css(\"display\", \"inline\");\n                me.$payment_modes.find(`.loyalty-amount-name`).css(\"display\", \"none\");\n    \n                // remove highlight from all mode-of-payments\n                $(\".mode-of-payment\").removeClass(\"border-primary\");\n    \n                if (mode_clicked.hasClass(\"border-primary\")) {\n                    // clicked one is selected then unselect it\n                    mode_clicked.removeClass(\"border-primary\");\n                    me.selected_mode = \"\";\n                } else {\n                    // clicked one is not selected then select it\n                    mode_clicked.addClass(\"border-primary\");\n                    mode_clicked.find(\".mode-of-payment-control\").css(\"display\", \"flex\");\n                    // mode_clicked.find(\".cash-shortcuts\").css(\"display\", \"grid\");\n                    me.$payment_modes.find(`.${mode}-amount`).css(\"display\", \"none\");\n                    me.$payment_modes.find(`.${mode}-name`).css(\"display\", \"inline\");\n    \n                    me.selected_mode = me[`${mode}_control`];\n                    me.selected_mode && me.selected_mode.$input.get(0).focus();\n                    me.auto_set_remaining_amount();\n                }\n            });\n    \n            frappe.ui.form.on(\"POS Invoice\", \"contact_mobile\", (frm) => {\n                const contact = frm.doc.contact_mobile;\n                const request_button = $(this.request_for_payment_field?.$input[0]);\n                if (contact) {\n                    request_button.removeClass(\"btn-default\").addClass(\"btn-primary\");\n                } else {\n                    request_button.removeClass(\"btn-primary\").addClass(\"btn-default\");\n                }\n            });\n    \n            frappe.ui.form.on(\"POS Invoice\", \"coupon_code\", (frm) => {\n                if (frm.doc.coupon_code && !frm.applying_pos_coupon_code) {\n                    if (!frm.doc.ignore_pricing_rule) {\n                        frm.applying_pos_coupon_code = true;\n                        frappe.run_serially([\n                            () => (frm.doc.ignore_pricing_rule = 1),\n                            () => frm.trigger(\"ignore_pricing_rule\"),\n                            () => (frm.doc.ignore_pricing_rule = 0),\n                            () => frm.trigger(\"apply_pricing_rule\"),\n                            () => frm.save(),\n                            () => this.update_totals_section(frm.doc),\n                            () => (frm.applying_pos_coupon_code = false),\n                        ]);\n                    } else if (frm.doc.ignore_pricing_rule) {\n                        frappe.show_alert({\n                            message: __(\"Ignore Pricing Rule is enabled. Cannot apply coupon code.\"),\n                            indicator: \"orange\",\n                        });\n                    }\n                }\n            });\n    \n            this.setup_listener_for_payments();\n    \n            this.$payment_modes.on(\"click\", \".shortcut\", function () {\n                const value = $(this).attr(\"data-value\");\n                me.selected_mode.set_value(value);\n            });\n    \n            this.$component.on(\"click\", \".submit-order-btn\", () => {\n                const doc = this.events.get_frm().doc;\n                const paid_amount = doc.paid_amount;\n                const items = doc.items;\n    \n                if (paid_amount == 0 || !items.length) {\n                    const message = items.length\n                        ? __(\"You cannot submit the order without payment.\")\n                        : __(\"You cannot submit empty order.\");\n                    frappe.show_alert({ message, indicator: \"orange\" });\n                    frappe.utils.play_sound(\"error\");\n                    return;\n                }\n    \n                this.events.submit_invoice();\n            });\n    \n            frappe.ui.form.on(\"POS Invoice\", \"paid_amount\", (frm) => {\n                this.update_totals_section(frm.doc);\n    \n                // need to re calculate cash shortcuts after discount is applied\n                const is_cash_shortcuts_invisible = !this.$payment_modes.find(\".cash-shortcuts\").is(\":visible\");\n                this.attach_cash_shortcuts(frm.doc);\n                !is_cash_shortcuts_invisible &&\n                    this.$payment_modes.find(\".cash-shortcuts\").css(\"display\", \"grid\");\n                this.render_payment_mode_dom();\n            });\n    \n            frappe.ui.form.on(\"POS Invoice\", \"loyalty_amount\", (frm) => {\n                const formatted_currency = format_currency(frm.doc.loyalty_amount, frm.doc.currency);\n                this.$payment_modes.find(`.loyalty-amount-amount`).html(formatted_currency);\n            });\n    \n            frappe.ui.form.on(\"Sales Invoice Payment\", \"amount\", (frm, cdt, cdn) => {\n                // for setting correct amount after loyalty points are redeemed\n                const default_mop = locals[cdt][cdn];\n                const mode = default_mop.mode_of_payment.replace(/ +/g, \"_\").toLowerCase();\n                if (this[`${mode}_control`] && this[`${mode}_control`].get_value() != default_mop.amount) {\n                    this[`${mode}_control`].set_value(default_mop.amount);\n                }\n            });\n            \n        };\n    } else {\n        setTimeout(overridePOSPayment, 100);\n    }\n}\noverridePOSPayment();"],
  "mappings": "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",
  "names": []
}
